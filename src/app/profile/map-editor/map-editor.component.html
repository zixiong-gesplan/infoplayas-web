<ng4-loading-spinner [timeout]="10000" [threshold]="800"></ng4-loading-spinner>
<div id="listPlayas" class="panel-side scroller esri-widget esri-hidden">
    <ul id="ulPlaya">
        <li>Cargando&hellip;</li>
    </ul>
</div>
<div id="mainContainer" [style.height]="mapHeight">
    <div id="viewDiv"></div>
    <div id="legendDiv" class="card custom-widget"></div>
    <div id="infobutton" class="container-fluid esri-widget custom-widget">
        <div class="row paddingtopbottom10px">
            <div class="col-md-12">
                <a data-fancybox data-type="iframe" [href]="setUrlInfoMap()">
                    <i class="pull-left fa fa-info-circle fa-2x"></i><b>Abre mapa detallado</b></a>
            </div>
        </div>
    </div>
    <div id="info" class="container-fluid esri-widget custom-widget esri-hidden">
        <img src="assets/images/logos/logo.png" class="card-img-top"/>
        <div class="card-body">
            <p id="txtSelecciona" class="card-text">Seleccione Playa/ZBM</p>
        </div>
    </div>
    <div id="formContainer" class="esri-hidden scroller">
        <!--        formulario de peligrosidad-->
        <div [hidden]="selectForm !=='clasificacion'">
            <form class="esri-pad" [formGroup]="formDanger" (ngSubmit)="onSubmit(formDanger, '1')">
                <!--            <div [hidden]="!databaseFail" class="alert alert-danger">{{ERROR}}</div>-->
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Características de esta zona de baño que representen un <b>GRAVE
                            PELIGRO</b> para la vida humana:</label>
                        <br>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-toggleButton formControlName="desprendimientos" onLabel="Desprendimientos"
                                        offLabel="Desprendimientos" onIcon="desprendimientosIcon"
                                        offIcon="desprendimientosIcon"
                                        [style]="{'width':'100%', 'height': '4.5em','text-align': 'right'}"></p-toggleButton>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-toggleButton formControlName="contaminacion" onLabel="Contaminación de las aguas"
                                        offLabel="Contaminación de las aguas" onIcon="contaminacionIcon"
                                        offIcon="contaminacionIcon"
                                        [style]="{'width':'100%', 'height': '4.5em','text-align': 'right'}"></p-toggleButton>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-toggleButton formControlName="fauna_marina" onLabel="Peligros por fauna marina"
                                        offLabel="Peligros por fauna marina" onIcon="faunaIcon"
                                        offIcon="faunaIcon"
                                        [style]="{'width':'100%', 'height': '4.5em','text-align': 'right'}"></p-toggleButton>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-toggleButton formControlName="corrientes_mareas" onLabel="Corrientes y mareas peligrosas"
                                        offLabel="Corrientes y mareas peligrosas" onIcon="corrientesIcon"
                                        offIcon="corrientesIcon"
                                        [style]="{'width':'100%', 'height': '4.5em','text-align': 'right'}"></p-toggleButton>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-toggleButton formControlName="rompientes_olas" onLabel="Zona de rompientes y olas"
                                        offLabel="Zona de rompientes y olas" onIcon="rompientesIcon"
                                        offIcon="rompientesIcon"
                                        [style]="{'width':'100%', 'height': '4.5em','text-align': 'right'}"></p-toggleButton>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label [hidden]="viewNoDanger" class="esri-font" style="color: red; font-weight : bolder">Clasificada
                            USO PROHIBIDO</label>
                        <!--                        <p-dropdown [hidden]="!viewNoDanger" [options]="noDangerOptions" [style]="{'width':'100%'}"-->
                        <!--                                    formControlName="dangerLevel" [required]="viewNoDanger"></p-dropdown>-->
                        <label pTooltip="Valoración definitiva al final del proceso de introducción de datos"
                               [hidden]="!viewNoDanger" class="esri-font"
                               style="color: darkorange; font-weight : bolder">Clasificación provisional LIBRE O
                            PELIGROSA</label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <button class="esri-button" type="submit" [disabled]="!formDanger.valid">
                            Guardar
                        </button>
                        <input (click)="sendMessage('noid',getUnselectedMessage(), '-')"
                               onclick="unselectFeature()"
                               type="button"
                               class="esri-button esri-button--secondary"
                               value="Cancelar"/>
                    </div>
                </div>
            </form>
        </div>
        <!--        formulario de incidencias y usos-->
        <div [hidden]="selectForm !=='incidencias'">
            <form class="esri-pad" [formGroup]="formIncidents" (ngSubmit)="onSubmit(formIncidents, '2')">
                <!--            <div [hidden]="!databaseFail" class="alert alert-danger">{{ERROR}}</div>-->
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font" style="font-weight: bolder">Histórico de Incidencias
                            registradas.</label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Número de incidentes graves</label>
                        <input class="esri-feature-form__input" pInputText type="number"
                               formControlName="incidentes_graves"/>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Número de incidentes muy graves</label>
                        <input class="esri-feature-form__input" pInputText type="number"
                               formControlName="incidentes_mgraves"/>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Observaciones</label>
                        <textarea [rows]="4" [cols]="80" class="esri-feature-form__input" pInputTextarea
                                  type="textarea" formControlName="incidentes_observaciones"
                                  placeholder="Requerido - Min(4) - permite texto largo"></textarea>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font" style="font-weight: bolder">Actividades deportivas y de recreo que se
                            realizan y existencia de balizamiento.</label>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <p-checkbox label="Actividad deportiva"
                                    formControlName="actividades_deportivas" binary="true"
                                    (mouseenter)="formIncidents.get('actividades_deportivas').value ? op1.show($event) : op1.hide()"
                                    (click)="openSecurityMeasures($event,op1)"
                                    [pTooltip]="formIncidents.get('actividades_deportivas').value ? 'Coexisten actividades deportivas, náuticas y de baño' : 'No existen actividades deportivas'">
                        </p-checkbox>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Valor de peligrosidad</label>
                        <input class="esri-feature-form__input" pInputText type="number"
                               [value]="calculateDangerLever()" disabled="true">
                    </div>
                </div>
                <!--                panel de peligrosidad-->
                <p-overlayPanel #op1>
                    <div class="form-row">
                        <div class="form-group">
                            <p-toggleButton formControlName="balizamiento" onLabel="Balizamiento"
                                            offLabel="Sin balizamiento"></p-toggleButton>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <p-toggleButton formControlName="actividades_acotadas"
                                            onLabel="Sectores deportivos señalizados"
                                            offLabel="Sin señalización"></p-toggleButton>
                        </div>
                    </div>
                </p-overlayPanel>
                <div class="form-row">
                    <div class="form-group">
                        <label class="esri-font">Observaciones</label>
                        <textarea [rows]="4" [cols]="80" class="esri-feature-form__input" pInputTextarea
                                  type="textarea" formControlName="deportes_observaciones"
                                  placeholder="Requerido - Min(4) - permite texto largo"></textarea>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <button class="esri-button" type="submit" [disabled]="!formIncidents.valid">
                            Guardar
                        </button>
                        <input (click)="sendMessage('noid',getUnselectedMessage(), '-')"
                               onclick="unselectFeature()"
                               type="button"
                               class="esri-button esri-button--secondary"
                               value="Cancelar"/>
                    </div>
                </div>
            </form>
        </div>
        <div [hidden]="selectForm !=='inventario'">
            <div id="form" class="esri-component"></div>
            <input type="button" class="esri-button" value="Guardar" id="btnSave"/>
            <input (click)="sendMessage('noid',getUnselectedMessage(), '-')" onclick="unselectFeature()" type="button"
                   class="esri-button esri-button--secondary"
                   value="Cancelar"/>
        </div>
    </div>
</div>
